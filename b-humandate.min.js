/**
 * A wrapper for JavaScript Date object
 *
 * @page    http://github.com/Shushik/b-humandate/
 * @author  Shushik <silkleopard@yandex.ru>
 * @version 1.0
 */
;function HumanDate(b,e){return HumanDate.human(HumanDate.parse(e),b)}HumanDate.prototype={};HumanDate._now=HumanDate.prototype._now=new Date;HumanDate._month=HumanDate.prototype._month=HumanDate._now.getMonth()+1;HumanDate._year=HumanDate.prototype._year=HumanDate._now.getFullYear();HumanDate._day=HumanDate.prototype._day=HumanDate._now.getDate();HumanDate._ye=HumanDate.prototype._ye=(HumanDate._year+"").substring(0,2);HumanDate._sep=HumanDate.prototype._sep=";"; HumanDate._locales=HumanDate.prototype._locales={en:{ampm:{full:"ante meridiem;post meridiem",lower:"am;pm",upper:"AM;PM"},days:{plur:"day;days;days"},years:{plur:"year;years;years"},monthes:{decl:"of January;of February;of March;of April;of May;of June;of July;of August;of September;of October;of November;of December",full:"January;February;March;April;May;June;July;August;September;October;November;December",part:"Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec",plur:"month;monthes;monthes"},weekdays:{motu:"Mo;Tu;We;Th;Fr;Sa;Su", full:"Monday;Tuesday;Wednesday;Thursday;Friday;Saturday;Sunday",part:"Mon;Tue;Wen;Thu;Fri;Sat;Sun",plur:"week;weeks;weeks"},holidays:{list:"",from:null,till:null}},def:"en",curr:"en"}; HumanDate._formats=HumanDate.prototype._formats={rplc:"",tmpl:"",pregs:{A:"(AM|PM)",D:"(\\w{3})",F:"(\\w{3,9})",G:"(\\d{1,2})",H:"(\\d{2})",M:"(\\w{3})",N:"(\\d)",O:"([+-]\\d{4})",T:"(\\w{3})",W:"(\\d{2})",Y:"(\\d{4})",a:"(am|pm)",d:"(\\d{1,2})",e:"(\\w{3})",g:"(\\d{1,2})",h:"(\\d{2})",i:"(\\d{2})",j:"(\\d{1,2})",l:"(\\w{6,9})",m:"(\\d{2})",n:"(\\d{1,2})",s:"(\\d{2})",t:"(\\d{1,2})",w:"(\\d)",y:"(\\d{2})",z:"(\\d{1,3})"}}; HumanDate.api=HumanDate.prototype.api=function(b){var e=0,d=0,c=0,e=42,f=0,a=0,g=0,f=HumanDate.parse(b);b=[];g=f.getMonth();a=f.getFullYear();c=HumanDate.days(g,a);d=(new Date(a,g,1)).getDay();d=0===d?7:d;f=c;e-=c;1!==d&&(d=-d+(7-d),e+=d);0<e&&(f=c+e);for(e=d;e<f;e++)b.push(new Date(a,g,e));return b};HumanDate.days=HumanDate.prototype.days=function(b,e){var d=new Date,c=void 0!==b?b+1:d.getMonth()+1,d=void 0!==e?e:d.getFullYear();return(new Date(d,c,0)).getDate()}; HumanDate.leap=HumanDate.prototype.leap=function(b){var e=new Date;b=void 0!==b?b:e.getFullYear();return 1!=(new Date(b,1,29)).getDate()?!0:!1};HumanDate.preg=HumanDate.prototype.preg=function(b){for(var e=b.length,d=0,c="",f="",a=HumanDate._formats.pregs,d=0;d<e;d++)f=b[d],c=a[f]?c+a[f]:c+b[d];return RegExp(c,"g")};HumanDate.zero=HumanDate.prototype.zero=function(b){return("0"+b).slice(-2)}; HumanDate.human=HumanDate.prototype.human=function(b,e,d){var c=0,f="";b=HumanDate.parse(b);var a={},g=null,h=HumanDate._locales[HumanDate._locales.curr]?HumanDate._locales[HumanDate._locales.curr]:HumanDate._locales[HumanDate._locales.def];a.day=b.getDate();a.year=b.getFullYear();a.hours=b.getHours();a.month=b.getMonth()+1;a.offset=b.getTimezoneOffset();a.minutes=b.getMinutes();a.seconds=b.getSeconds();void 0===d&&(g=HumanDate.distance(new Date(b.getFullYear(),0,1,0,0,0),b),a.j=a.day,a.d=HumanDate.zero(a.j), a.w=b.getDay(),a.N=0===a.w?7:a.w,a.z=g.days,c=a.N-1,a.D=h.weekdays.part.split(HumanDate._sep)[c],a.l=h.weekdays.full.split(HumanDate._sep)[c],a.W=g.weeks,c=a.month-1,a.n=a.month,a.m=HumanDate.zero(a.n),a.M=h.monthes.part.split(HumanDate._sep)[c],a.F=h.monthes.full.split(HumanDate._sep)[c],a.t=HumanDate.days(a.month,a.year),a.Y=a.year,a.y=(a.Y+"").substring(2),a.L=HumanDate.leap(a.Y),a.G=a.hours,a.g=a.G+-12,a.H=HumanDate.zero(a.G),a.h=HumanDate.zero(a.g),a.i=HumanDate.zero(a.minutes),a.s=HumanDate.zero(a.seconds), 12>=a.G?(a.a=h.ampm.lower.split(HumanDate._sep)[0],a.A=h.ampm.upper.split(HumanDate._sep)[0]):(a.a=h.ampm.lower.split(";")[1],a.A=h.ampm.upper.split(";")[1]),c=b.toString().split("GMT")[1].replace(")","").split(" ("),a.O=c[0],a.P=c[0].substring(0,3)+":"+c[0].substring(3),a.T=c[1],a.Z=a.offset,c=[b.getTimezoneOffset(),(new Date(a.Y,1,1)).getTimezoneOffset(),(new Date(a.Y,7,1)).getTimezoneOffset()],a.I=c[1]!==c[2]&&c[2]===c[0]?!0:!1,a.U=b.getTime(),a.r=b.toString(),a.c=a.Y+"-"+a.m+"-"+a.d+"-T"+a.H+ ":"+a.i+":"+a.s+a.P);if("string"===typeof e){for(f in a)e=e.replace(f,a[f]);return e}return a};HumanDate.order=HumanDate.prototype.order=function(b,e){e=e||!1;b=b.sort(function(b,c){return b>c?1:-1});return"min"==e?b.shift():"max"==e?b.pop():b};HumanDate.valid=HumanDate.prototype.valid=function(b){return!isNaN(b.getDate())?!0:!1}; HumanDate.parse=HumanDate.prototype.parse=function(b){var e=0,d=0,e=typeof b,c=null,f=null,a=HumanDate._formats.rplc.split(HumanDate._sep),g=HumanDate._formats.tmpl.split(HumanDate._sep);if(b instanceof Date||"number"===e)return new Date(b);if("string"===e){c=new Date(b);if(HumanDate.valid(c))return c;c=b;e=g.length;for(d=0;d<e;d++)if(f=HumanDate.preg(g[d]),c.match(f)){c=c.replace(f,a[d]);break}c=new Date(c);if(HumanDate.valid(c))return c}return HumanDate._now}; HumanDate.format=HumanDate.prototype.format=function(b){var e=b.length,d=0,c=0,f="",a=[],g=[],h=["year","month","day"],j=HumanDate._formats.pregs;if(!(-1<HumanDate._formats.tmpl.indexOf(b))){for(d=0;d<e;d++)if(f=b[d],j[f])switch(c++,f){case "Y":a[0]="$"+c;break;case "y":a[0]=HumanDate._ye+"$"+c;break;case "F":case "M":case "m":case "n":a[1]="$"+c;break;case "d":case "j":a[2]="$"+c;break;case "H":g[0]="$"+c;break;case "i":g[1]="$"+c;break;case "s":g[2]="$"+c}for(d=0;3>d;d++)void 0===a[d]&&(a[d]=HumanDate["_"+ h[d]]),void 0===g[d]&&(g[d]="00");HumanDate._formats.tmpl=b+HumanDate._sep+HumanDate._formats.tmpl;HumanDate._formats.rplc=a.join(" ")+" "+g.join(":")+HumanDate._sep+HumanDate._formats.rplc}}; HumanDate.holiday=HumanDate.prototype.holiday=function(b){var e=HumanDate._locales.curr,d="",c="",d=HumanDate.parse(b),d=d.getFullYear()+"-"+HumanDate.zero(d.getMonth()+1)+"-"+HumanDate.zero(d.getDate()),c=HumanDate._locales[e]&&HumanDate._locales[e].holidays?HumanDate._locales[e].holidays.list:HumanDate._locales[HumanDate._locales.def].holidays.list;return-1<c.indexOf(d)?!0:HumanDate.weekend(b)}; HumanDate.inside=HumanDate.prototype.inside=function(b,e,d){d=HumanDate.parse(d);e=HumanDate.parse(e);b=HumanDate.parse(b);return b>e&&b<d?!0:!1};HumanDate.weekend=HumanDate.prototype.weekend=function(b){var e=0,e=HumanDate.parse(b).getDay();return 0==e||6==e?!0:!1}; HumanDate.distance=HumanDate.prototype.distance=function(b,e){var d=0,c={days:0,hours:0,weeks:0,years:0,seconds:0,minutes:0,monthes:0},f=HumanDate.parse(b),a=HumanDate.parse(e);f>a&&(d=a,a=f,f=d);d=12*(a.getFullYear()-f.getFullYear());c.monthes=d-f.getMonth()+a.getMonth();c.years=Math.floor(c.monthes/12);d=a.getTime()-f.getTime();c.seconds=Math.floor(d/1E3);c.minutes=Math.floor(c.seconds/60);c.hours=Math.floor(c.minutes/60);c.days=Math.floor(c.hours/24);c.weeks=Math.floor(c.days/7);return c}; HumanDate.holidays=HumanDate.prototype.holidays=function(b,e){if(void 0!==e)HumanDate._locales[b]||HumanDate.language(b),HumanDate._locales[b].holidays={list:"",from:null,till:null},e instanceof Array?HumanDate._locales[b].holidays.list=e.join(HumanDate._sep):"string"===typeof e&&(HumanDate._locales[b].holidays.list=e);else return HumanDate._locales[b]&&HumanDate._locales[b].holidays?HumanDate._locales[b].holidays.split(HumanDate._sep):null}; HumanDate.language=HumanDate.prototype.language=function(b,e){var d="",c="",f=HumanDate._locales[HumanDate._locales.def];HumanDate._locales[b]||(HumanDate._locales[b]={});for(d in f)for(c in HumanDate._locales[b][d]={},f[d])HumanDate._locales[b][d][c]=e&&e[d]&&e[d][c]?e[d][c]instanceof Array?e[d][c].join(HumanDate._sep):e[d][c]:f[d][c]}; (function(){var b=0,e="D M d Y H:i:s eO (T);D M d Y H:i:s eO;D M d H:i:s e Y;Y-m-d H:i:s;H:i:s;Y-m-d;y-m-d;M d,Y;Y-M-d;y-M-d;d-M-Y;M/d/y;m-d-Y;m.d.Y;d/m/Y;d-m-Y;d.m.Y;M d, Y;M d;M-d;m/d;m-d;d-M;d/m;d-m;d".split(HumanDate._sep);for(b in e)HumanDate.format(e[b])})();